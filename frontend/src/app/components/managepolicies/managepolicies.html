<div class="policy-form-container">
  <h2>Create New Policy</h2>

  <form (ngSubmit)="createPolicy()" #policyForm="ngForm">
    
    <div class="form-group">
      <input
        type="text"
        placeholder="Title"
        [(ngModel)]="formData.title"
        name="title"
        required
        #titleRef="ngModel"
        [class.invalid]="titleRef.invalid && titleRef.touched"
      />
      <div class="error-message" *ngIf="titleRef.invalid && titleRef.touched">
        <p>Title can't be empty.</p>
      </div>
    </div>

    <div class="form-group">
      <input
        type="number"
        placeholder="Claim Amount (e.g., 50000)"
        [(ngModel)]="formData.claimAmount"
        name="claimAmount"
        required
        #claimRef="ngModel"
        [class.invalid]="claimRef.invalid && claimRef.touched"
      />
      <div class="error-message" *ngIf="claimRef.invalid && claimRef.touched">
        <p>Claim Amount is required.</p>
      </div>
    </div>

    <div class="form-group">
      <textarea
        placeholder="Description (Minimum 25 characters)"
        [(ngModel)]="formData.description"
        name="description"
        required
        #descRef="ngModel"
        [class.invalid]="(descRef.invalid && descRef.touched) || (formData.description.length < 25 && descRef.touched)"
      ></textarea>
      <div class="error-message" *ngIf="(descRef.invalid && descRef.touched) || (formData.description.length < 25 && descRef.touched)">
        <p>Description must be at least 25 characters. ({{ formData.description.length }}/25)</p>
      </div>
    </div>

    <div class="form-group">
      <input
        type="number"
        placeholder="Monthly Premium (e.g., 500)"
        [(ngModel)]="formData.monthlyPremium"
        name="monthlyPremium"
        required
        #premiumRef="ngModel"
        [class.invalid]="premiumRef.invalid && premiumRef.touched"
      />
      <div class="error-message" *ngIf="premiumRef.invalid && premiumRef.touched">
        <p>Monthly Premium is required.</p>
      </div>
    </div>
    
    <div class="form-group">
      <select 
        [(ngModel)]="formData.category" 
        name="category" 
        required 
        #catRef="ngModel"
        [class.invalid]="catRef.invalid && catRef.touched"
      >
        <option value="" disabled selected>Select Policy Category</option>
        <option *ngFor="let cat of categories" [value]="cat">{{ cat }}</option>
      </select>
      <div class="error-message" *ngIf="catRef.invalid && catRef.touched">
        <p>Please select a category.</p>
      </div>
    </div>

    <div class="form-group">
      <input
        type="file"
        #imageInput
        (change)="handleFileUpload($event)"
        accept="image/*"
        required
      />
    </div>

    <button type="submit" [disabled]="policyForm.invalid || loading">
      Create Policy
    </button>
  </form>

  <p class="success-message" *ngIf="successMessage">{{ successMessage }}</p>
</div>